<?!= include('_htmlHeader'); ?>
<script>
  function callback() {
    var version = $('#version').val();
    var clientId = $('#clientId').val();
    var clientSecret = $('#clientSecret').val();
    google.script.run
      .withSuccessHandler(success)
      .withFailureHandler(failure)
      .configApiCallback(version, clientId, clientSecret);
  }

  function success() {
    google.script.host.close();
  }

  function failure(error) {
    alert('ERROR: ' + error.message);
  }
</script>

<?!= include('_htmlBody'); ?>
<label>Version</label>: <input id="version" type="text" value="<?= version ?>" /><br />
<label>Client Id:</label>: <input id="clientId" type="text" value="<?= clientId ?>" /><br />
<label>Client Secret</label>: <input id="clientSecret" type="text" value="<?= clientSecret ?>" /><br />
<button onclick="callback();">Ok</button>
<button onclick="google.script.host.close();">Cancel</button>

<?!= include('_htmlEnd'); ?>
