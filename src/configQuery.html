<?!= include('_htmlHeader'); ?>
<script>
  function callback() {
    var config = $('#config').val();
    try {
      JSON.parse(config);
    } catch (error) {
      if (error instanceof SyntaxError) {
        alert('JSON Syntax Error');
      }
      throw error;
    }

    google.script.run
      .withSuccessHandler(success)
      .withFailureHandler(failure)
      .configQueryCallback(config);
  }

  function success() {
    google.script.host.close();
  }

  function failure(error) {
    alert('ERROR: ' + error.message);
  }
</script>

<?!= include('_htmlBody'); ?>
<textarea id="config" rows="35" cols="100"><?= config ?></textarea><br />
<button onclick="callback();">Ok</button>
<button onclick="google.script.host.close();">Cancel</button>

<?!= include('_htmlEnd'); ?>
